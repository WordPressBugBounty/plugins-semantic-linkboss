"use strict";(globalThis.webpackChunksemantic_linkboss=globalThis.webpackChunksemantic_linkboss||[]).push([[268,866],{3443:(e,t,s)=>{s.d(t,{A:()=>i});var r=s(1609),a=s(7723),n=s(982),o=s(6188);const i=({reports:e,queueRemaining:t})=>{const s="urls"===e?.sync_method;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4"},(()=>{const r=[{icon:o.TuH,value:e?.on_queue,label:(0,a.__)("On Queue","semantic-linkboss"),bg:"bg-pink-600"},{icon:o.a$,value:t<0?0:t,label:(0,a.__)("Queue Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.a$,value:e?.sync_remaing,label:(0,a.__)("Sync Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.rk5,value:e?.sync_done,label:(0,a.__)("Sync Done","semantic-linkboss"),bg:"bg-green-700"},{icon:o.hem,value:e?.content_size,label:(0,a.__)("Content Size","semantic-linkboss"),bg:"bg-purple-600"}];return s?[{icon:o.CQO,value:e?.urls,label:(0,a.__)("URLs","semantic-linkboss"),bg:"bg-blue-600"},...r]:[{icon:o.A4h,value:e?.pages,label:(0,a.__)("Pages","semantic-linkboss"),bg:"bg-indigo-600"},{icon:o.bLf,value:e?.posts,label:(0,a.__)("Posts","semantic-linkboss"),bg:"bg-orange-600"},...r,{icon:o.BH7,value:e.total_categories,label:(0,a.__)("Total Categories","semantic-linkboss"),bg:"bg-teal-600"}]})().map(((e,t)=>(0,r.createElement)("div",{key:t,className:"flex items-center px-5 py-6 bg-white dark:bg-gray-800 rounded-md shadow-sm"},(0,r.createElement)("div",{className:`p-4 ${e.bg} bg-opacity-75 rounded-full leading-none`},(0,r.createElement)(n.g,{icon:e.icon,className:"w-6 h-6 text-white"})),(0,r.createElement)("div",{className:"mx-5"},(0,r.createElement)("h4",{className:"text-2xl font-semibold text-gray-700 dark:text-gray-200"},e.value),(0,r.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},e.label)))))))}},5268:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var r=s(1609),a=s(7723),n=s(1455),o=s.n(n),i=s(513),c=s(1083),l=s(8465),d=s.n(l),u=s(982),m=s(6188),g=s(3443);const p=()=>{const{refreshKey:e}=(0,r.useContext)(i.B),{triggerRefresh:t}=(0,r.useContext)(i.B),[s,n]=(0,r.useState)(!0),[o,l]=(0,r.useState)({pages:0,posts:0,total_queue_batch:0,on_queue:0,sync_done:0,sync_remaing:0,content_size:"0 KB",elementor_data:0,total_categories:0});let p=parseInt(o?.pages,10)+parseInt(o?.posts,10)-parseInt(o?.total_queue_batch,10);return(0,r.useEffect)((()=>{(async()=>{try{const e=await c.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"prepare"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});l(e?.data?.reports),n(!1)}catch(e){console.error("Error fetching reports:",e),n(!1)}})()}),[e]),(0,r.useEffect)((()=>{localStorage.setItem("linkboss_prepare_reports",JSON.stringify({...o,queueRemaining:p}))}),[o,e]),s?(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"text-center"},(0,a.__)("Loading","semantic-linkboss"),"..."),(0,r.createElement)("div",{className:"flex justify-center items-center h-40 mt-12"},(0,r.createElement)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}))):(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"flex items-center gap-6 flex-wrap justify-between"},(0,r.createElement)("div",null,(0,r.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-white"},(0,a.__)("Prepare Site Data for Syncing","semantic-linkboss")),(0,r.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},(0,a.__)("This will sync your site with LinkBoss app. One-time setup lets you manage interlinking from app.linkboss.io","semantic-linkboss"))),(0,r.createElement)("div",{className:"flex gap-1"},(0,r.createElement)("button",{className:"rounded-md flex gap-2 items-center bg-indigo-600 text-white border border-transparent py-3 px-4 text-center text-sm font-semibold transition-all hover:bg-indigo-500 focus:bg-indigo-500 active:bg-indigo-500 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none whitespace-nowrap",type:"button",onClick:async()=>{if(0!==o?.queue_remaining){d().fire({title:"Preparing posts...",html:"Please wait while we prepare your posts for syncing.",allowOutsideClick:!1,didOpen:()=>{d().showLoading()}});try{let e=!0,s=0;for(;e;){s++,s>1&&d().update({title:"Preparing posts...",html:`Processing batch #${s}. Please wait...`});const t=await c.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});e=!0===t?.data?.has_post}t(),d().fire({icon:"success",title:"Success",text:"All posts have been prepared for syncing."})}catch(e){console.error("Error preparing queue:",e),d().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."})}}else d().fire({icon:"info",title:"No posts to prepare.",text:"All posts are already prepared for syncing."})}},(0,r.createElement)(u.g,{icon:m.Ys0,className:"w-5 h-5"}),(0,a.__)("Prepare Posts","semantic-linkboss")))),(0,r.createElement)(g.A,{reports:o,queueRemaining:p}))};var b=s(6866);const h=()=>{const[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(""),[i,c]=(0,r.useState)("");return(0,r.createElement)("div",{className:"mt-0"},(0,r.createElement)("div",{className:"mb-6 relative flex flex-col bg-clip-border rounded-xl bg-white dark:bg-gray-900 text-gray-700 shadow-sm"},(0,r.createElement)("div",{className:"flex justify-between items-center px-6 py-4 border-b border-gray-100 dark:border-gray-800"},(0,r.createElement)("div",null,(0,r.createElement)("h4",{className:"text-xl font-semibold text-slate-800 dark:text-white"},(0,a.__)("Sync","semantic-linkboss")),(0,r.createElement)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400"},(0,a.__)("Sync your data with LinkBoss App.","semantic-linkboss"))),(0,r.createElement)("div",{className:"flex gap-2 items-start"}," ",(0,r.createElement)("div",{className:"relative group"},(0,r.createElement)("button",{onClick:async()=>{t(!0),n(""),c("");try{const e=await o()({path:"/linkboss/v1/update-posts",method:"POST"});if(e&&"error"===e.status)n(e.msg||(0,a.__)("An error occurred during sync.","semantic-linkboss")),c("error");else if(e&&Array.isArray(e)&&0===e.length)n((0,a.__)("No data to update from LinkBoss.","semantic-linkboss")),c("success");else if(e&&e.msg&&"Oops!"===e.title)n(e.msg||(0,a.__)("No data to Update","semantic-linkboss")),c("success");else if(e&&Array.isArray(e)&&e.some((e=>"success"===e.status))){const t=e.filter((e=>"success"===e.status)).length,s=e.length;n(`${t} of ${s} ${1===s?"post":"posts"} synced successfully from LinkBoss.`),c("success")}else e&&Array.isArray(e)&&e.every((e=>"error"===e.status))?(n((0,a.__)("All sync attempts failed. Please check logs for details.","semantic-linkboss")),c("error")):(n((0,a.__)("Sync process completed.","semantic-linkboss")),c("success"))}catch(e){let t=(0,a.__)("An error occurred during sync.","semantic-linkboss");e.message?t=e.message:"string"==typeof e&&(t=e),n(t),c("error"),console.error("Manual Sync Error:",e)}finally{t(!1)}},disabled:e,className:"flex items-center gap-2 bg-green-100 text-green-700 hover:bg-green-200 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-4 py-2 text-center dark:bg-green-900 dark:text-green-300 dark:hover:bg-green-800 disabled:opacity-50"},e?(0,r.createElement)(r.Fragment,null,(0,r.createElement)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},(0,r.createElement)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.createElement)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),(0,a.__)("Syncing...","semantic-linkboss")):(0,a.__)("Sync from LinkBoss","semantic-linkboss"),(0,r.createElement)(u.g,{icon:m.iW_,className:"w-4 h-4 ml-1 text-green-700 dark:text-green-300"})),(0,r.createElement)("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-2 w-64 p-2 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none"},(0,a.__)('Click this button to manually fetch the latest content updates from the LinkBoss app. Keep clicking until you see a "No data to Update" message. This is helpful if your automated sync (cron job) is disabled or not functioning properly.',"semantic-linkboss"))),(0,r.createElement)("button",{onClick:()=>window.location.hash="advanced-sync-settings",className:"flex items-center gap-2 bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800"},(0,r.createElement)(u.g,{icon:m.BH7,className:"w-4 h-4"}),(0,r.createElement)("span",null,(0,a.__)("Advanced Settings","semantic-linkboss"))))),s&&(0,r.createElement)("div",{className:"px-6 py-3 border-b border-gray-100 dark:border-gray-800 "+("success"===i?"bg-green-50 dark:bg-green-700 text-green-700 dark:text-green-200":"bg-red-50 dark:bg-red-700 text-red-700 dark:text-red-200")},s),(0,r.createElement)("div",{className:"p-6"},(0,r.createElement)(p,null)),(0,r.createElement)("div",{className:"p-6"},(0,r.createElement)(b.default,null))))}},6866:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var r=s(1609),a=s(7723),n=s(1083),o=s(8465),i=s.n(o),c=function(e,t){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])},c(e,t)};function l(e){var t=e.className,s=e.counterClockwise,a=e.dashRatio,n=e.pathRadius,o=e.strokeWidth,i=e.style;return(0,r.createElement)("path",{className:t,style:Object.assign({},i,u({pathRadius:n,dashRatio:a,counterClockwise:s})),d:d({pathRadius:n,counterClockwise:s}),strokeWidth:o,fillOpacity:0})}function d(e){var t=e.pathRadius,s=e.counterClockwise?1:0;return"\n      M 50,50\n      m 0,-"+t+"\n      a "+t+","+t+" "+s+" 1 1 0,"+2*t+"\n      a "+t+","+t+" "+s+" 1 1 0,-"+2*t+"\n    "}function u(e){var t=e.counterClockwise,s=e.dashRatio,r=e.pathRadius,a=2*Math.PI*r,n=(1-s)*a;return{strokeDasharray:a+"px "+a+"px",strokeDashoffset:(t?-n:n)+"px"}}var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){function __(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}(t,e),t.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},t.prototype.getPathRadius=function(){return 50-this.props.strokeWidth/2-this.getBackgroundPadding()},t.prototype.getPathRatio=function(){var e=this.props,t=e.value,s=e.minValue,r=e.maxValue;return(Math.min(Math.max(t,s),r)-s)/(r-s)},t.prototype.render=function(){var e=this.props,t=e.circleRatio,s=e.className,a=e.classes,n=e.counterClockwise,o=e.styles,i=e.strokeWidth,c=e.text,d=this.getPathRadius(),u=this.getPathRatio();return(0,r.createElement)("svg",{className:a.root+" "+s,style:o.root,viewBox:"0 0 100 100","data-test-id":"CircularProgressbar"},this.props.background?(0,r.createElement)("circle",{className:a.background,style:o.background,cx:50,cy:50,r:50}):null,(0,r.createElement)(l,{className:a.trail,counterClockwise:n,dashRatio:t,pathRadius:d,strokeWidth:i,style:o.trail}),(0,r.createElement)(l,{className:a.path,counterClockwise:n,dashRatio:u*t,pathRadius:d,strokeWidth:i,style:o.path}),c?(0,r.createElement)("text",{className:a.text,style:o.text,x:50,y:50},c):null)},t.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},t}(r.Component);function g(e){return Object.keys(e).forEach((function(t){null==e[t]&&delete e[t]})),e}var p=s(513),b=s(982),h=s(6188);const y=({isWizard:e=!1})=>{const{resetQuery:t}=(0,r.useContext)(p.B),{triggerRefresh:s}=(0,r.useContext)(p.B),[o,c]=(0,r.useState)(!1),[l,d]=(0,r.useState)([]),[u,y]=(0,r.useState)([]),[f,k]=(0,r.useState)(0),[_,x]=(0,r.useState)(!1),[v,w]=(0,r.useState)(0),E=async t=>{try{const r=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"prepare_batch_for_sync"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(e||s(),400===r?.data?.data?.srv_status?.status)return void i().fire({icon:"error",title:"Error",html:r?.data?.data?.srv_status?.msg});if("yes"===r?.data?.data?.has_batch){const e=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),s="urls"===e?.data?.reports?.sync_method,a=s?e?.data?.reports?.urls:0;if(s&&a>0){const t=(e?.data?.reports?.sync_done||0)/a*100;k(Math.round(100*t)/100)}else{let e=(t-r?.data?.data?.batch_length)/t*100;k(Math.round(100*e)/100)}await E(t)}else d((e=>[...e,"Sync Completed"])),k(100),N()}catch(e){i().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."}),console.error("Error preparing queue:",e)}},N=async()=>{try{const t=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_finish"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});"success"===t?.data?.status?(d((e=>[...e,"Category Sync Finished","Syncing Finished"])),d((e=>[...e,"Sync Finished"])),i().fire({icon:"success",title:t?.data?.title,html:t?.data?.message,timer:3e3,timerProgressBar:!0}),w(!0),e&&setTimeout((()=>{localStorage.setItem("linkboss_setup_wizard_step",2)}),1500),s()):i().fire({icon:"error",title:t?.data?.title,html:t?.data?.message})}catch(e){console.error("Error finishing sync:",e)}};return(0,r.useEffect)((()=>{(async()=>{try{const e=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts-2"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});let t=e?.data?.reports?.sync_done,s=e?.data?.reports?.sync_remaing,r=t/(t+s)*100||0;o||k(Math.round(100*r)/100),y(e?.data?.reports)}catch(e){throw console.error("Error fetching reports:",e),e}})()}),[v,t]),(0,r.createElement)("div",{className:"flex items-center justify-center w-full mt-8"},(0,r.createElement)("div",{className:"relative flex flex-col items-center justify-center w-full border-2 border-gray-300 border-dashed rounded-lg dark:bg-gray-900 dark:border-gray-600"},(0,r.createElement)("div",{className:"flex flex-col items-center justify-center pt-20 pb-20 px-4"},(0,r.createElement)(m,{value:f,text:`${f}%`,className:"w-36 h-36 mb-6",styles:(C={pathColor:`rgba(88, 80, 236, ${f/100})`,textColor:"#5850ec",trailColor:"#d6d6d6"},P=C.rotation,S=C.strokeLinecap,B=C.textColor,L=C.textSize,A=C.pathColor,R=C.pathTransition,W=C.pathTransitionDuration,O=C.trailColor,q=C.backgroundColor,T=null==P?void 0:"rotate("+P+"turn)",j=null==P?void 0:"center center",{root:{},path:g({stroke:A,strokeLinecap:S,transform:T,transformOrigin:j,transition:R,transitionDuration:null==W?void 0:W+"s"}),trail:g({stroke:O,strokeLinecap:S,transform:T,transformOrigin:j}),text:g({fill:B,fontSize:L}),background:g({fill:q})})}),(0,r.createElement)("p",{className:"mb-4 text-sm text-gray-500 dark:text-white"},(0,r.createElement)("span",{className:"font-semibold"},(0,a.__)("Click the Sync Now","semantic-linkboss"))," ",(0,a.__)("button for syncing the prepared contents, process may take a while.","semantic-linkboss")),(0,r.createElement)("div",{className:"flex items-center"},(0,r.createElement)("input",{type:"checkbox",className:"w-4 h-4 m-0 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",checked:_,onChange:e=>x(e.target.checked)}),(0,r.createElement)("label",{className:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"},(0,a.__)("Force Sync - ","semantic-linkboss"),(0,r.createElement)("a",{className:"text-blue-600 dark:text-blue-500 hover:underline ml-1"},(0,a.__)("(to Sync all posts)","semantic-linkboss")),".")),(0,r.createElement)("div",{className:"flex items-center justify-center mt-6"},(0,r.createElement)("button",{className:"flex items-center gap-2 rounded-md bg-indigo-700 py-3 px-6 border text-sm font-bold text-white transition-all shadow-md hover:shadow-lg focus:bg-indigo-700 active:bg-indigo-700 hover:bg-indigo-800 disabled:pointer-events-none disabled:opacity-50 dark:border-indigo-700",onClick:async()=>{if(d([]),c(!0),u?.queue_remaining>0)try{console.log("Preparing queue..."),await(async()=>{try{for(;;){const e=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(await s(),d([`Preparing... ${u?.queue_remaining} posts left.`]),!0!==e?.data?.has_post){console.log("Queue completed."),d((e=>[...e,"Queue preparation completed."]));break}}}catch(e){throw d((e=>[...e,"Error preparing queue..."])),console.error("Error preparing queue:",e),e}})(),console.log("Queue preparation completed.")}catch(e){return console.error("Queue preparation failed:",e),void d((e=>[...e,"Queue preparation failed."]))}if(100===f&&!_)return i().fire({icon:"info",title:"Sync Completed",text:"Your data is already synced.",timer:3e3,timerProgressBar:!0}),e&&setTimeout((()=>{localStorage.setItem("linkboss_setup_wizard_step",2),s()}),3e3),void c(!1);try{console.log("Starting sync..."),await(async()=>{try{const e=await(async()=>{try{const e=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),t="urls"===e?.data?.reports?.sync_method;return{posts:t?e?.data?.reports?.urls:e?.data?.reports?.posts,pages:t?0:e?.data?.reports?.pages,category:e?.data?.reports?.total_categories,sync_done:e?.data?.reports?.sync_done,sync_method:e?.data?.reports?.sync_method}}catch(e){throw console.error("Error fetching reports:",e),e}})();await(async e=>{try{const t=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_init",force_data:_?"yes":"no",...e},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if("success"===t?.data?.status){d((e=>[...e,"Syncing ...","Sync Initiated","Syncing Posts..."]));let e=t?.data?.batch?.length;d((e=>[...e,"Processing batches..."])),await E(e)}else i().fire({icon:"error",title:t?.data?.title,text:t?.data?.message})}catch(e){throw i().fire({icon:"error",title:"Error",text:e?.response?.data.message}),e}})(e)}catch(e){if(console.error("Error syncing posts:",e),"rest_no_route"===e?.response?.data?.code)return void i().fire({title:"Oops!",text:(0,a.__)("Please connect your WordPress site with LinkBoss app by adding the API key from Settings.","semantic-linkboss"),icon:"info",showCancelButton:!0,confirmButtonText:"API Settings",cancelButtonText:"Cancel"}).then((e=>{e.isConfirmed&&(window.location.href="admin.php?page=semantic-linkboss#settings")}));i().fire({icon:"info",title:"Oops!",text:e?.response?.data?.message+" - "+e?.response?.data?.code})}})(),console.log("Sync completed successfully.")}catch(e){console.error("Error during sync process:",e),d((e=>[...e,"Error during sync process"]))}finally{c(!1)}},disabled:o},(0,r.createElement)(b.g,{icon:h.rk5}),o?(0,a.__)("Syncing...","semantic-linkboss"):(0,a.__)("Sync Now","semantic-linkboss")))),(0,r.createElement)("div",{className:"absolute top-0 right-0 p-3"},(0,r.createElement)("ul",{className:"max-w-md space-y-1 text-gray-500 list-inside dark:text-gray-400"},l.map(((e,t)=>(0,r.createElement)("li",{key:t,className:"flex items-center"},(0,r.createElement)(b.g,{icon:h.SGM,className:"w-3.5 h-3.5 me-2 text-green-500 dark:text-green-400 shrink-0"}),e)))))));var C,P,S,B,L,A,R,W,O,q,T,j}}}]);