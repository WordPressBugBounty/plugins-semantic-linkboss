"use strict";(globalThis.webpackChunksemantic_linkboss=globalThis.webpackChunksemantic_linkboss||[]).push([[268,866],{3443:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(1609),r=a(7723),n=a(982),o=a(6188);const i=({reports:e,queueRemaining:t})=>(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4"},[{icon:o.A4h,value:e?.pages,label:(0,r.__)("Pages","semantic-linkboss"),bg:"bg-indigo-600"},{icon:o.bLf,value:e?.posts,label:(0,r.__)("Posts","semantic-linkboss"),bg:"bg-orange-600"},{icon:o.TuH,value:e?.on_queue,label:(0,r.__)("On Queue","semantic-linkboss"),bg:"bg-pink-600"},{icon:o.a$,value:t<0?0:t,label:(0,r.__)("Queue Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.a$,value:e?.sync_remaing,label:(0,r.__)("Sync Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.rk5,value:e?.sync_done,label:(0,r.__)("Sync Done","semantic-linkboss"),bg:"bg-green-700"},{icon:o.BH7,value:e.total_categories,label:(0,r.__)("Total Categories","semantic-linkboss"),bg:"bg-teal-600"},{icon:o.hem,value:e?.content_size,label:(0,r.__)("Content Size","semantic-linkboss"),bg:"bg-purple-600"}].map(((e,t)=>(0,s.createElement)("div",{key:t,className:"flex items-center px-5 py-6 bg-white dark:bg-gray-800 rounded-md shadow-sm"},(0,s.createElement)("div",{className:`p-4 ${e.bg} bg-opacity-75 rounded-full leading-none`},(0,s.createElement)(n.g,{icon:e.icon,className:"w-6 h-6 text-white"})),(0,s.createElement)("div",{className:"mx-5"},(0,s.createElement)("h4",{className:"text-2xl font-semibold text-gray-700 dark:text-gray-200"},e.value),(0,s.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},e.label)))))))},5268:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var s=a(1609),r=a(7723),n=a(513),o=a(1083),i=a(8465),c=a.n(i),l=a(982),d=a(6188),u=a(3443);const m=()=>{const{refreshKey:e}=(0,s.useContext)(n.B),{triggerRefresh:t}=(0,s.useContext)(n.B),[a,i]=(0,s.useState)(!0),[m,g]=(0,s.useState)({pages:0,posts:0,total_queue_batch:0,on_queue:0,sync_done:0,sync_remaing:0,content_size:"0 KB",elementor_data:0,total_categories:0});let p=parseInt(m?.pages,10)+parseInt(m?.posts,10)-parseInt(m?.total_queue_batch,10);return(0,s.useEffect)((()=>{(async()=>{try{const e=await o.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"prepare"},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});g(e?.data?.reports),i(!1)}catch(e){console.error("Error fetching reports:",e),i(!1)}})()}),[e]),(0,s.useEffect)((()=>{localStorage.setItem("linkboss_prepare_reports",JSON.stringify({...m,queueRemaining:p}))}),[m,e]),a?(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"text-center"},(0,r.__)("Loading","semantic-linkboss"),"..."),(0,s.createElement)("div",{className:"flex justify-center items-center h-40 mt-12"},(0,s.createElement)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}))):(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"flex items-center gap-6 flex-wrap justify-between"},(0,s.createElement)("div",null,(0,s.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-white"},(0,r.__)("Prepare Site Data for Syncing","semantic-linkboss")),(0,s.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},(0,r.__)("This will sync your site with LinkBoss app. One-time setup lets you manage interlinking from app.linkboss.io","semantic-linkboss"))),(0,s.createElement)("div",{className:"flex gap-1"},(0,s.createElement)("button",{className:"rounded-md flex gap-2 items-center bg-indigo-600 text-white border border-transparent py-3 px-4 text-center text-sm font-semibold transition-all hover:bg-indigo-500 focus:bg-indigo-500 active:bg-indigo-500 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none whitespace-nowrap",type:"button",onClick:async()=>{if(0!==m?.queue_remaining){c().fire({title:"Preparing posts...",html:"Please wait while we prepare your posts for syncing.",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}});try{let e=!0,a=0;for(;e;){a++,a>1&&c().update({title:"Preparing posts...",html:`Processing batch #${a}. Please wait...`});const t=await o.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});e=!0===t?.data?.has_post}t(),c().fire({icon:"success",title:"Success",text:"All posts have been prepared for syncing."})}catch(e){console.error("Error preparing queue:",e),c().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."})}}else c().fire({icon:"info",title:"No posts to prepare.",text:"All posts are already prepared for syncing."})}},(0,s.createElement)(l.g,{icon:d.Ys0,className:"w-5 h-5"}),(0,r.__)("Prepare Posts","semantic-linkboss")))),(0,s.createElement)(u.A,{reports:m,queueRemaining:p}))};var g=a(6866);const p=()=>(0,s.createElement)("div",{className:"mt-6"},(0,s.createElement)("div",{className:"mb-6 relative flex flex-col bg-clip-border rounded-xl bg-white dark:bg-gray-900 text-gray-700 shadow-sm"},(0,s.createElement)("div",{className:"flex justify-between items-center px-6 py-4 border-b border-gray-100 dark:border-gray-800"},(0,s.createElement)("div",null,(0,s.createElement)("h4",{className:"text-xl font-semibold text-slate-800 dark:text-white"},(0,r.__)("Sync","semantic-linkboss")),(0,s.createElement)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400"},(0,r.__)("Sync your data with LinkBoss App.","semantic-linkboss"))),(0,s.createElement)("button",{onClick:()=>window.location.hash="advanced-sync-settings",className:"flex items-center gap-2 bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800"},(0,s.createElement)(l.g,{icon:d.BH7,className:"w-4 h-4"}),(0,s.createElement)("span",null,(0,r.__)("Advanced Settings","semantic-linkboss")))),(0,s.createElement)("div",{className:"p-6"},(0,s.createElement)(m,null)),(0,s.createElement)("div",{className:"p-6"},(0,s.createElement)(g.default,null))))},6866:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(1609),r=a(7723),n=a(1083),o=a(8465),i=a.n(o),c=function(e,t){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},c(e,t)};function l(e){var t=e.className,a=e.counterClockwise,r=e.dashRatio,n=e.pathRadius,o=e.strokeWidth,i=e.style;return(0,s.createElement)("path",{className:t,style:Object.assign({},i,u({pathRadius:n,dashRatio:r,counterClockwise:a})),d:d({pathRadius:n,counterClockwise:a}),strokeWidth:o,fillOpacity:0})}function d(e){var t=e.pathRadius,a=e.counterClockwise?1:0;return"\n      M 50,50\n      m 0,-"+t+"\n      a "+t+","+t+" "+a+" 1 1 0,"+2*t+"\n      a "+t+","+t+" "+a+" 1 1 0,-"+2*t+"\n    "}function u(e){var t=e.counterClockwise,a=e.dashRatio,s=e.pathRadius,r=2*Math.PI*s,n=(1-a)*r;return{strokeDasharray:r+"px "+r+"px",strokeDashoffset:(t?-n:n)+"px"}}var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){function __(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}(t,e),t.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},t.prototype.getPathRadius=function(){return 50-this.props.strokeWidth/2-this.getBackgroundPadding()},t.prototype.getPathRatio=function(){var e=this.props,t=e.value,a=e.minValue,s=e.maxValue;return(Math.min(Math.max(t,a),s)-a)/(s-a)},t.prototype.render=function(){var e=this.props,t=e.circleRatio,a=e.className,r=e.classes,n=e.counterClockwise,o=e.styles,i=e.strokeWidth,c=e.text,d=this.getPathRadius(),u=this.getPathRatio();return(0,s.createElement)("svg",{className:r.root+" "+a,style:o.root,viewBox:"0 0 100 100","data-test-id":"CircularProgressbar"},this.props.background?(0,s.createElement)("circle",{className:r.background,style:o.background,cx:50,cy:50,r:50}):null,(0,s.createElement)(l,{className:r.trail,counterClockwise:n,dashRatio:t,pathRadius:d,strokeWidth:i,style:o.trail}),(0,s.createElement)(l,{className:r.path,counterClockwise:n,dashRatio:u*t,pathRadius:d,strokeWidth:i,style:o.path}),c?(0,s.createElement)("text",{className:r.text,style:o.text,x:50,y:50},c):null)},t.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},t}(s.Component);function g(e){return Object.keys(e).forEach((function(t){null==e[t]&&delete e[t]})),e}var p=a(513),b=a(982),h=a(6188);const y=({isWizard:e=!1})=>{const{resetQuery:t}=(0,s.useContext)(p.B),{triggerRefresh:a}=(0,s.useContext)(p.B),[o,c]=(0,s.useState)(!1),[l,d]=(0,s.useState)([]),[u,y]=(0,s.useState)([]),[f,k]=(0,s.useState)(0),[_,x]=(0,s.useState)(!1),[v,w]=(0,s.useState)(0),E=async t=>{try{const s=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"prepare_batch_for_sync"},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});if(e||a(),400===s?.data?.data?.srv_status?.status)return void i().fire({icon:"error",title:"Error",html:s?.data?.data?.srv_status?.msg});if("yes"===s?.data?.data?.has_batch){let e=(t-s?.data?.data?.batch_length)/t*100;k(Math.round(100*e)/100),await E(t)}else d((e=>[...e,"Sync Completed"])),k(100),N()}catch(e){i().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."}),console.error("Error preparing queue:",e)}},N=async()=>{try{const t=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_finish"},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});"success"===t?.data?.status?(d((e=>[...e,"Category Sync Finished","Syncing Finished"])),d((e=>[...e,"Sync Finished"])),i().fire({icon:"success",title:t?.data?.title,html:t?.data?.message,timer:3e3,timerProgressBar:!0}),w(!0),e&&setTimeout((()=>{localStorage.setItem("linkboss_setup_wizard_step",2)}),1500),a()):i().fire({icon:"error",title:t?.data?.title,html:t?.data?.message})}catch(e){console.error("Error finishing sync:",e)}};return(0,s.useEffect)((()=>{(async()=>{try{const e=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts-2"},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});let t=e?.data?.reports?.sync_done,a=e?.data?.reports?.sync_remaing,s=t/(t+a)*100||0;o||k(Math.round(100*s)/100),y(e?.data?.reports)}catch(e){throw console.error("Error fetching reports:",e),e}})()}),[v,t]),(0,s.createElement)("div",{className:"flex items-center justify-center w-full mt-8"},(0,s.createElement)("div",{className:"relative flex flex-col items-center justify-center w-full border-2 border-gray-300 border-dashed rounded-lg dark:bg-gray-900 dark:border-gray-600"},(0,s.createElement)("div",{className:"flex flex-col items-center justify-center pt-20 pb-20 px-4"},(0,s.createElement)(m,{value:f,text:`${f}%`,className:"w-36 h-36 mb-6",styles:(C={pathColor:`rgba(88, 80, 236, ${f/100})`,textColor:"#5850ec",trailColor:"#d6d6d6"},P=C.rotation,S=C.strokeLinecap,B=C.textColor,L=C.textSize,R=C.pathColor,q=C.pathTransition,A=C.pathTransitionDuration,W=C.trailColor,O=C.backgroundColor,j=null==P?void 0:"rotate("+P+"turn)",T=null==P?void 0:"center center",{root:{},path:g({stroke:R,strokeLinecap:S,transform:j,transformOrigin:T,transition:q,transitionDuration:null==A?void 0:A+"s"}),trail:g({stroke:W,strokeLinecap:S,transform:j,transformOrigin:T}),text:g({fill:B,fontSize:L}),background:g({fill:O})})}),(0,s.createElement)("p",{className:"mb-4 text-sm text-gray-500 dark:text-white"},(0,s.createElement)("span",{className:"font-semibold"},(0,r.__)("Click to Sync Now","semantic-linkboss"))," ",(0,r.__)("for a seamless experience, process may take a while.","semantic-linkboss")),(0,s.createElement)("div",{className:"flex items-center"},(0,s.createElement)("input",{type:"checkbox",className:"w-4 h-4 m-0 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",checked:_,onChange:e=>x(e.target.checked)}),(0,s.createElement)("label",{className:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"},(0,r.__)("Force Sync - ","semantic-linkboss"),(0,s.createElement)("a",{className:"text-blue-600 dark:text-blue-500 hover:underline ml-1"},(0,r.__)("(to Sync all posts)","semantic-linkboss")),".")),(0,s.createElement)("div",{className:"flex items-center justify-center mt-6"},(0,s.createElement)("button",{className:"flex items-center gap-2 rounded-md bg-indigo-700 py-3 px-6 border text-sm font-bold text-white transition-all shadow-md hover:shadow-lg focus:bg-indigo-700 active:bg-indigo-700 hover:bg-indigo-800 disabled:pointer-events-none disabled:opacity-50 dark:border-indigo-700",onClick:async()=>{if(d([]),c(!0),u?.queue_remaining>0)try{console.log("Preparing queue..."),await(async()=>{try{for(;;){const e=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});if(await a(),d([`Preparing... ${u?.queue_remaining} posts left.`]),!0!==e?.data?.has_post){console.log("Queue completed."),d((e=>[...e,"Queue preparation completed."]));break}}}catch(e){throw d((e=>[...e,"Error preparing queue..."])),console.error("Error preparing queue:",e),e}})(),console.log("Queue preparation completed.")}catch(e){return console.error("Queue preparation failed:",e),void d((e=>[...e,"Queue preparation failed."]))}if(100===f&&!_)return i().fire({icon:"info",title:"Sync Completed",text:"Your data is already synced.",timer:3e3,timerProgressBar:!0}),e&&setTimeout((()=>{localStorage.setItem("linkboss_setup_wizard_step",2),a()}),3e3),void c(!1);try{console.log("Starting sync..."),await(async()=>{try{const e=await(async()=>{try{const e=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts"},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});return{posts:e?.data?.reports?.posts,pages:e?.data?.reports?.pages,category:e?.data?.reports?.total_categories,sync_done:e?.data?.reports?.sync_done}}catch(e){throw console.error("Error fetching reports:",e),e}})();await(async e=>{try{const t=await n.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_init",force_data:_?"yes":"no",...e},{headers:{"X-WP-Nonce":LinkBossConfig.rest_nonce}});if("success"===t?.data?.status){d((e=>[...e,"Syncing ...","Sync Initiated","Syncing Posts..."]));let e=t?.data?.batch?.length;d((e=>[...e,"Processing batches..."])),await E(e)}else i().fire({icon:"error",title:t?.data?.title,text:t?.data?.message})}catch(e){throw i().fire({icon:"error",title:"Error",text:e?.response?.data.message}),e}})(e)}catch(e){if(console.error("Error syncing posts:",e),"rest_no_route"===e?.response?.data?.code)return void i().fire({title:"Oops!",text:(0,r.__)("Please connect your WordPress site with LinkBoss app by adding the API key from Settings.","semantic-linkboss"),icon:"info",showCancelButton:!0,confirmButtonText:"Settings",cancelButtonText:"Cancel"}).then((e=>{e.isConfirmed&&document.querySelector('li[data-value="settings"]').click()}));i().fire({icon:"info",title:"Oops!",text:e?.response?.data?.message+" - "+e?.response?.data?.code})}})(),console.log("Sync completed successfully.")}catch(e){console.error("Error during sync process:",e),d((e=>[...e,"Error during sync process"]))}finally{c(!1)}},disabled:o},(0,s.createElement)(b.g,{icon:h.rk5}),o?(0,r.__)("Syncing...","semantic-linkboss"):(0,r.__)("Sync Now","semantic-linkboss")))),(0,s.createElement)("div",{className:"absolute top-0 right-0 p-3"},(0,s.createElement)("ul",{className:"max-w-md space-y-1 text-gray-500 list-inside dark:text-gray-400"},l.map(((e,t)=>(0,s.createElement)("li",{key:t,className:"flex items-center"},(0,s.createElement)(b.g,{icon:h.SGM,className:"w-3.5 h-3.5 me-2 text-green-500 dark:text-green-400 shrink-0"}),e)))))));var C,P,S,B,L,R,q,A,W,O,j,T}}}]);