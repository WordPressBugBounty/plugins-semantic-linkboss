"use strict";(globalThis.webpackChunksemantic_linkboss=globalThis.webpackChunksemantic_linkboss||[]).push([[268,866],{3443:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(1609),a=s(7723),r=s(982),o=s(6188);const i=({reports:e,queueRemaining:t})=>{const s="urls"===e?.sync_method;return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4"},(()=>{const n=[{icon:o.TuH,value:e?.on_queue,label:(0,a.__)("On Queue","semantic-linkboss"),bg:"bg-pink-600"},{icon:o.a$,value:t<0?0:t,label:(0,a.__)("Queue Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.a$,value:e?.sync_remaing,label:(0,a.__)("Sync Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.rk5,value:e?.sync_done,label:(0,a.__)("Sync Done","semantic-linkboss"),bg:"bg-green-700"},{icon:o.hem,value:e?.content_size,label:(0,a.__)("Content Size","semantic-linkboss"),bg:"bg-purple-600"}];return s?[{icon:o.CQO,value:e?.urls,label:(0,a.__)("URLs","semantic-linkboss"),bg:"bg-blue-600"},...n]:[{icon:o.A4h,value:e?.pages,label:(0,a.__)("Pages","semantic-linkboss"),bg:"bg-indigo-600"},{icon:o.bLf,value:e?.posts,label:(0,a.__)("Posts","semantic-linkboss"),bg:"bg-orange-600"},...n,{icon:o.BH7,value:e.total_categories,label:(0,a.__)("Total Categories","semantic-linkboss"),bg:"bg-teal-600"}]})().map((e,t)=>(0,n.createElement)("div",{key:t,className:"flex items-center px-5 py-6 bg-white dark:bg-gray-800 rounded-md shadow-sm"},(0,n.createElement)("div",{className:`p-4 ${e.bg} bg-opacity-75 rounded-full leading-none`},(0,n.createElement)(r.g,{icon:e.icon,className:"w-6 h-6 text-white"})),(0,n.createElement)("div",{className:"mx-5"},(0,n.createElement)("h4",{className:"text-2xl font-semibold text-gray-700 dark:text-gray-200"},e.value),(0,n.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},e.label))))))}},5268:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var n=s(1609),a=s(7723),r=s(1455),o=s.n(r),i=s(1083),l=s(8465),c=s.n(l),d=s(513),m=s(982),u=s(6188),p=s(3443);const g=()=>{const{refreshKey:e}=(0,n.useContext)(d.B),{triggerRefresh:t}=(0,n.useContext)(d.B),[s,r]=(0,n.useState)(!0),[o,l]=(0,n.useState)({pages:0,posts:0,total_queue_batch:0,on_queue:0,sync_done:0,sync_remaing:0,content_size:"0 KB",elementor_data:0,total_categories:0});let g=parseInt(o?.pages,10)+parseInt(o?.posts,10)-parseInt(o?.total_queue_batch,10);return(0,n.useEffect)(()=>{(async()=>{try{const e=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"prepare"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});l(e?.data?.reports),r(!1)}catch(e){console.error("Error fetching reports:",e),r(!1)}})()},[e]),(0,n.useEffect)(()=>{localStorage.setItem("linkboss_prepare_reports",JSON.stringify({...o,queueRemaining:g}))},[o,e]),s?(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"text-center"},(0,a.__)("Loading","semantic-linkboss"),"..."),(0,n.createElement)("div",{className:"flex justify-center items-center h-40 mt-12"},(0,n.createElement)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}))):(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"flex items-center gap-6 flex-wrap justify-between"},(0,n.createElement)("div",null,(0,n.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-white"},(0,a.__)("Prepare Site Data for Syncing","semantic-linkboss")),(0,n.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},(0,a.__)("This will sync your site with LinkBoss app. One-time setup lets you manage interlinking from app.linkboss.io","semantic-linkboss"))),(0,n.createElement)("div",{className:"flex gap-1"},(0,n.createElement)("button",{className:"rounded-md flex gap-2 items-center bg-indigo-600 text-white border border-transparent py-3 px-4 text-center text-sm font-semibold transition-all hover:bg-indigo-500 focus:bg-indigo-500 active:bg-indigo-500 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none whitespace-nowrap",type:"button",onClick:async()=>{if(0!==o?.queue_remaining){c().fire({title:"Preparing posts...",html:"Please wait while we prepare your posts for syncing.",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}});try{let e=!0,s=0;for(;e;){s++,s>1&&c().update({title:"Preparing posts...",html:`Processing batch #${s}. Please wait...`});const t=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});e=!0===t?.data?.has_post}t(),c().fire({icon:"success",title:"Success",text:"All contents have been prepared for syncing."})}catch(e){console.error("Error preparing queue:",e),c().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."})}}else c().fire({icon:"info",title:"No posts to prepare.",text:"All posts are already prepared for syncing. Use the Reset Sync button from Advanced Settings to prepare the data again."})}},(0,n.createElement)(m.g,{icon:u.Ys0,className:"w-5 h-5"}),(0,a.__)("Prepare Data","semantic-linkboss")))),(0,n.createElement)(p.A,{reports:o,queueRemaining:g}))};var b=s(6866);const y=()=>{const{triggerRefresh:e}=(0,n.useContext)(d.B),[t,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),[p,y]=(0,n.useState)(""),[h,f]=(0,n.useState)(!1),[k,_]=(0,n.useState)(()=>"true"!==localStorage.getItem("linkboss_sync_info_dismissed"));return(0,n.createElement)("div",{className:"mt-0"},(0,n.createElement)("div",{className:"mb-6 relative flex flex-col bg-clip-border rounded-xl bg-white dark:bg-gray-900 text-gray-700 shadow-sm"},(0,n.createElement)("div",{className:"flex justify-between items-center px-6 py-4 border-b border-gray-100 dark:border-gray-800"},(0,n.createElement)("div",null,(0,n.createElement)("h4",{className:"text-xl font-semibold text-slate-800 dark:text-white"},(0,a.__)("Sync","semantic-linkboss")),(0,n.createElement)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400"},(0,a.__)("Sync your data with LinkBoss App.","semantic-linkboss"))),(0,n.createElement)("div",{className:"flex gap-2 items-start"},(0,n.createElement)("div",{className:"relative group"},(0,n.createElement)("button",{onClick:async()=>{if(!(await c().fire({title:(0,a.__)("Reset & Full Sync","semantic-linkboss"),html:`\n        <div class="text-left" style="font-size: 15px;">\n          <p class="mb-5 text-base" style="font-size: 15px; color: #4b5563; padding-top: 8px;">\n            ${(0,a.__)("This will perform the following actions:","semantic-linkboss")}\n          </p>\n          <ol class="space-y-3 mb-4" style="font-size: 15px; line-height: 1.8; list-style: none; padding-left: 0;">\n            <li style="color: #374151; display: flex; align-items: start; gap: 12px;">\n              <span style="background: #fee2e2; color: #dc2626; width: 28px; height: 28px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; flex-shrink: 0;">1</span>\n              <span style="padding-top: 3px;">\n                ${(0,a.__)("Reset all sync data and queue","semantic-linkboss")}\n              </span>\n            </li>\n            <li style="color: #374151; display: flex; align-items: start; gap: 12px;">\n              <span style="background: #dbeafe; color: #2563eb; width: 28px; height: 28px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; flex-shrink: 0;">2</span>\n              <span style="padding-top: 3px;">\n                ${(0,a.__)("Prepare all contents for syncing","semantic-linkboss")}\n              </span>\n            </li>\n            <li style="color: #374151; display: flex; align-items: start; gap: 12px;">\n              <span style="background: #d1fae5; color: #059669; width: 28px; height: 28px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; flex-shrink: 0;">3</span>\n              <span style="padding-top: 3px;">\n                ${(0,a.__)("Sync all contents to LinkBoss","semantic-linkboss")}\n              </span>\n            </li>\n          </ol>\n          <p class="mb-3 font-semibold" style="font-size: 14px; color: #d97706; line-height: 1.6; background: #fef3c7; padding: 12px; border-radius: 6px; border-left: 4px solid #f59e0b;">\n            ‚ö†Ô∏è ${(0,a.__)("This process may take several minutes depending on your content volume.","semantic-linkboss")}\n          </p>\n          <p class="text-base font-medium" style="font-size: 15px; color: #1f2937; padding-top: 8px;">\n            ${(0,a.__)("Are you sure you want to continue?","semantic-linkboss")}\n          </p>\n        </div>\n      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#f59e0b",cancelButtonColor:"#6b7280",confirmButtonText:(0,a.__)("Yes, Reset & Sync","semantic-linkboss"),cancelButtonText:(0,a.__)("Cancel","semantic-linkboss"),customClass:{popup:"text-left"}})).isConfirmed)return;f(!0);let t=1;try{c().fire({title:(0,a.__)("Stage 1/3: Resetting Sync Data","semantic-linkboss"),html:(0,a.__)("Clearing previous sync data...","semantic-linkboss"),allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{c().showLoading()}});const s=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"reset_sync_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(!s?.data)throw new Error((0,a.__)("Failed to reset sync data","semantic-linkboss"));e(),t=2,c().update({title:(0,a.__)("Stage 2/3: Preparing Posts","semantic-linkboss"),html:(0,a.__)("Preparing posts for syncing...","semantic-linkboss")});let n=!0,r=0;for(;n;){r++,c().update({html:(0,a.__)(`Preparing posts... (Batch #${r})`,"semantic-linkboss")});const e=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});n=!0===e?.data?.has_post}e(),t=3,c().update({title:(0,a.__)("Stage 3/3: Syncing Content","semantic-linkboss"),html:(0,a.__)("Syncing content to LinkBoss...","semantic-linkboss")});const o=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),l="urls"===o?.data?.reports?.sync_method,d={posts:l?o?.data?.reports?.urls:o?.data?.reports?.posts,pages:l?0:o?.data?.reports?.pages,category:o?.data?.reports?.total_categories,sync_done:o?.data?.reports?.sync_done,sync_method:o?.data?.reports?.sync_method},m=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_init",force_data:"yes",...d},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if("success"!==m?.data?.status)throw new Error(m?.data?.message||(0,a.__)("Failed to initialize sync","semantic-linkboss"));let u=m?.data?.batch?.length;await(async e=>{for(;;){const t=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"prepare_batch_for_sync"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(400===t?.data?.data?.srv_status?.status)throw new Error(t.data.data.srv_status.msg);if("yes"===t?.data?.data?.has_batch){const s=Math.round((e-t.data.data.batch_length)/e*100);c().update({html:(0,a.__)(`Syncing content... ${s}% complete`,"semantic-linkboss")});continue}break}})(u),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_finish"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),e(),c().fire({icon:"success",title:(0,a.__)("Reset & Sync Completed!","semantic-linkboss"),html:(0,a.__)('If you still see "Sync Remaining" for some contents, just click the "Sync Now" button .',"semantic-linkboss"),timerProgressBar:!0,didClose:()=>{window.location.reload()}})}catch(e){console.error("Reset & Full Sync Error:",e);let s=(0,a.__)("Error in Stage","semantic-linkboss")+" "+t,n=e.message||(0,a.__)("An error occurred during the reset and sync process.","semantic-linkboss");e.response?.data?.message&&(n=e.response.data.message),c().fire({icon:"error",title:s,html:`\n          <p>${n}</p>\n          <p class="mt-2 text-sm text-gray-600">${(0,a.__)("You can try again or contact support if the issue persists.","semantic-linkboss")}</p>\n        `,confirmButtonText:(0,a.__)("OK","semantic-linkboss")})}finally{f(!1)}},disabled:h,className:"flex items-center gap-2 bg-amber-100 text-amber-700 hover:bg-amber-200 focus:ring-4 focus:outline-none focus:ring-amber-300 font-medium rounded-lg text-sm px-4 py-2 text-center dark:bg-amber-900 dark:text-amber-300 dark:hover:bg-amber-800 disabled:opacity-50"},h?(0,n.createElement)(n.Fragment,null,(0,n.createElement)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},(0,n.createElement)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.createElement)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),(0,a.__)("Processing...","semantic-linkboss")):(0,n.createElement)(n.Fragment,null,(0,n.createElement)(m.g,{icon:u.BF2,className:"w-4 h-4"}),(0,a.__)("Reset & Full Sync","semantic-linkboss")),(0,n.createElement)(m.g,{icon:u.iW_,className:"w-4 h-4 ml-1 text-amber-700 dark:text-amber-300"})),(0,n.createElement)("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-2 w-80 p-3 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none"},(0,a.__)("One-click solution to reset sync data and perform a complete fresh sync. Use this when you've changed settings (ACF, WooCommerce, query filters) or experiencing sync issues.","semantic-linkboss"))),(0,n.createElement)("div",{className:"relative group"},(0,n.createElement)("button",{onClick:async()=>{s(!0),l(""),y("");try{const e=await o()({path:"/linkboss/v1/update-posts",method:"POST"});if(e&&"error"===e.status)l(e.msg||(0,a.__)("An error occurred during sync.","semantic-linkboss")),y("error");else if(e&&Array.isArray(e)&&0===e.length)l((0,a.__)("No data to update from LinkBoss.","semantic-linkboss")),y("success");else if(e&&e.msg&&"Oops!"===e.title)l(e.msg||(0,a.__)("No data to Update","semantic-linkboss")),y("success");else if(e&&Array.isArray(e)&&e.some(e=>"success"===e.status)){const t=e.filter(e=>"success"===e.status).length,s=e.length;l(`${t} of ${s} ${1===s?"post":"posts"} synced successfully from LinkBoss.`),y("success")}else e&&Array.isArray(e)&&e.every(e=>"error"===e.status)?(l((0,a.__)("All sync attempts failed. Please check logs for details.","semantic-linkboss")),y("error")):(l((0,a.__)("Sync process completed.","semantic-linkboss")),y("success"))}catch(e){let t=(0,a.__)("An error occurred during sync.","semantic-linkboss");e.message?t=e.message:"string"==typeof e&&(t=e),l(t),y("error"),console.error("Manual Sync Error:",e)}finally{s(!1)}},disabled:t,className:"flex items-center gap-2 bg-green-100 text-green-700 hover:bg-green-200 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-4 py-2 text-center dark:bg-green-900 dark:text-green-300 dark:hover:bg-green-800 disabled:opacity-50"},t?(0,n.createElement)(n.Fragment,null,(0,n.createElement)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},(0,n.createElement)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.createElement)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),(0,a.__)("Syncing...","semantic-linkboss")):(0,a.__)("Sync from LinkBoss","semantic-linkboss"),(0,n.createElement)(m.g,{icon:u.iW_,className:"w-4 h-4 ml-1 text-green-700 dark:text-green-300"})),(0,n.createElement)("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-2 w-64 p-2 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none"},(0,a.__)('Click this button to manually fetch the latest content updates from the LinkBoss app. Keep clicking until you see a "No data to Update" message. This is helpful if your automated sync (cron job) is disabled or not functioning properly.',"semantic-linkboss"))),(0,n.createElement)("div",{className:"relative group"},(0,n.createElement)("button",{onClick:()=>window.location.hash="advanced-sync-settings",className:"flex items-center gap-2 bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800"},(0,n.createElement)(m.g,{icon:u.BH7,className:"w-4 h-4"}),(0,n.createElement)("span",null,(0,a.__)("Advanced Settings","semantic-linkboss")),(0,n.createElement)(m.g,{icon:u.iW_,className:"w-4 h-4 ml-1 text-blue-700 dark:text-blue-300"})),(0,n.createElement)("div",{className:"absolute right-0 top-full mt-2 w-80 p-3 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10 pointer-events-none"},(0,a.__)("Access advanced sync settings including custom post types, ACF support, WooCommerce integration, sync speed configuration, and more.","semantic-linkboss"))))),r&&(0,n.createElement)("div",{className:"px-6 py-3 border-b border-gray-100 dark:border-gray-800 "+("success"===p?"bg-green-50 dark:bg-green-700 text-green-700 dark:text-green-200":"bg-red-50 dark:bg-red-700 text-red-700 dark:text-red-200")},r),k&&(0,n.createElement)("div",{className:"mx-6 mt-4 bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg shadow-sm dark:bg-blue-900/30 dark:border-blue-600 relative"},(0,n.createElement)("button",{onClick:()=>{_(!1),localStorage.setItem("linkboss_sync_info_dismissed","true")},className:"absolute top-3 right-3 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200 transition-colors","aria-label":(0,a.__)("Dismiss","semantic-linkboss")},(0,n.createElement)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},(0,n.createElement)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"}))),(0,n.createElement)("div",{className:"flex items-start pr-6"},(0,n.createElement)(m.g,{icon:u.iW_,className:"w-5 h-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0 dark:text-blue-400"}),(0,n.createElement)("div",{className:"flex-1"},(0,n.createElement)("h4",{className:"text-base font-semibold text-blue-900 mb-1.5 dark:text-blue-200"},(0,a.__)("Need to sync custom post types or WooCommerce products?","semantic-linkboss")),(0,n.createElement)("p",{className:"text-sm text-blue-800 mb-2.5 dark:text-blue-300"},(0,a.__)("By default, LinkBoss syncs standard posts and pages. If you need to sync additional content types, you can configure them in Advanced Settings.","semantic-linkboss")),(0,n.createElement)("ul",{className:"text-sm text-blue-800 mb-3 space-y-1.5 dark:text-blue-300"},(0,n.createElement)("li",{className:"flex items-start"},(0,n.createElement)("span",{className:"mr-1.5"},"‚Ä¢"),(0,n.createElement)("span",null,(0,a.__)("Custom post types (products, portfolios, events, etc.) must be selected in Advanced Settings","semantic-linkboss"))),(0,n.createElement)("li",{className:"flex items-start"},(0,n.createElement)("span",{className:"mr-1.5"},"‚Ä¢"),(0,n.createElement)("span",null,(0,a.__)("WooCommerce products and categories require enabling WooCommerce support separately","semantic-linkboss")))),(0,n.createElement)("button",{onClick:()=>window.location.hash="advanced-sync-settings",className:"inline-flex items-center gap-2 bg-blue-600 text-white hover:bg-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3.5 py-2 transition-colors dark:bg-blue-700 dark:hover:bg-blue-800"},(0,n.createElement)(m.g,{icon:u.BH7,className:"w-4 h-4"}),(0,n.createElement)("span",null,(0,a.__)("Go to Advanced Settings","semantic-linkboss")))))),(0,n.createElement)("div",{className:"p-6"},(0,n.createElement)(g,null)),(0,n.createElement)("div",{className:"p-6"},(0,n.createElement)(b.default,null))))},h=()=>(0,n.createElement)(d.D,null,(0,n.createElement)(y,null))},6866:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var n=s(1609),a=s(7723),r=s(1083),o=s(8465),i=s.n(o),l=function(e,t){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])},l(e,t)};function c(e){var t=e.className,s=e.counterClockwise,a=e.dashRatio,r=e.pathRadius,o=e.strokeWidth,i=e.style;return(0,n.createElement)("path",{className:t,style:Object.assign({},i,m({pathRadius:r,dashRatio:a,counterClockwise:s})),d:d({pathRadius:r,counterClockwise:s}),strokeWidth:o,fillOpacity:0})}function d(e){var t=e.pathRadius,s=e.counterClockwise?1:0;return"\n      M 50,50\n      m 0,-"+t+"\n      a "+t+","+t+" "+s+" 1 1 0,"+2*t+"\n      a "+t+","+t+" "+s+" 1 1 0,-"+2*t+"\n    "}function m(e){var t=e.counterClockwise,s=e.dashRatio,n=e.pathRadius,a=2*Math.PI*n,r=(1-s)*a;return{strokeDasharray:a+"px "+a+"px",strokeDashoffset:(t?-r:r)+"px"}}var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){function __(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}(t,e),t.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},t.prototype.getPathRadius=function(){return 50-this.props.strokeWidth/2-this.getBackgroundPadding()},t.prototype.getPathRatio=function(){var e=this.props,t=e.value,s=e.minValue,n=e.maxValue;return(Math.min(Math.max(t,s),n)-s)/(n-s)},t.prototype.render=function(){var e=this.props,t=e.circleRatio,s=e.className,a=e.classes,r=e.counterClockwise,o=e.styles,i=e.strokeWidth,l=e.text,d=this.getPathRadius(),m=this.getPathRatio();return(0,n.createElement)("svg",{className:a.root+" "+s,style:o.root,viewBox:"0 0 100 100","data-test-id":"CircularProgressbar"},this.props.background?(0,n.createElement)("circle",{className:a.background,style:o.background,cx:50,cy:50,r:50}):null,(0,n.createElement)(c,{className:a.trail,counterClockwise:r,dashRatio:t,pathRadius:d,strokeWidth:i,style:o.trail}),(0,n.createElement)(c,{className:a.path,counterClockwise:r,dashRatio:m*t,pathRadius:d,strokeWidth:i,style:o.path}),l?(0,n.createElement)("text",{className:a.text,style:o.text,x:50,y:50},l):null)},t.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},t}(n.Component);function p(e){return Object.keys(e).forEach(function(t){null==e[t]&&delete e[t]}),e}var g=s(513),b=s(982),y=s(6188);const h=({isWizard:e=!1})=>{const{resetQuery:t}=(0,n.useContext)(g.B),{triggerRefresh:s}=(0,n.useContext)(g.B),[o,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)([]),[m,h]=(0,n.useState)([]),[f,k]=(0,n.useState)(0),[_,x]=(0,n.useState)(!1),[w,v]=(0,n.useState)(0),[E,C]=(0,n.useState)(()=>"true"!==localStorage.getItem("linkboss_sync_complete_banner_dismissed")),N=async t=>{try{const n=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"prepare_batch_for_sync"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(e||s(),400===n?.data?.data?.srv_status?.status)return void i().fire({icon:"error",title:"Error",html:n?.data?.data?.srv_status?.msg});if("yes"===n?.data?.data?.has_batch){const e=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),s="urls"===e?.data?.reports?.sync_method,a=s?e?.data?.reports?.urls:0;if(s&&a>0){const t=(e?.data?.reports?.sync_done||0)/a*100;k(Math.round(100*t)/100)}else{let e=(t-n?.data?.data?.batch_length)/t*100;k(Math.round(100*e)/100)}await N(t)}else d(e=>[...e,"Sync Completed"]),k(100),B()}catch(e){i().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."}),console.error("Error preparing queue:",e)}},B=async()=>{try{const t=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_finish"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});"success"===t?.data?.status?(d(e=>[...e,"Category Sync Finished","Syncing Finished"]),d(e=>[...e,"Sync Finished"]),i().fire({icon:"success",title:(0,a.__)("Sync Completed Successfully! üéâ","semantic-linkboss"),html:`\n            <p class="mb-4" style="font-size: 15px; color: #4b5563;">\n              ${(0,a.__)("Your content has been synced to LinkBoss. Ready to build internal links?","semantic-linkboss")}\n            </p>\n            <p style="font-size: 14px; color: #6b7280;">\n              ${(0,a.__)("All link building features are available in the LinkBoss App.","semantic-linkboss")}\n            </p>\n          `,showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:(0,a.__)("Open LinkBoss App","semantic-linkboss"),cancelButtonText:(0,a.__)("Stay Here","semantic-linkboss")}).then(e=>{e.isConfirmed?window.open("https://app.linkboss.io/app/sites","_blank"):e.isDismissed&&window.location.reload()}),v(!0),"true"!==localStorage.getItem("linkboss_sync_complete_banner_dismissed")&&C(!0),e&&setTimeout(()=>{localStorage.setItem("linkboss_setup_wizard_step",2)},1500),s()):i().fire({icon:"error",title:t?.data?.title,html:t?.data?.message})}catch(e){console.error("Error finishing sync:",e)}};return(0,n.useEffect)(()=>{(async()=>{try{const e=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts-2"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});let t=e?.data?.reports?.sync_done,s=e?.data?.reports?.sync_remaing,n=t/(t+s)*100||0;o||k(Math.round(100*n)/100),h(e?.data?.reports)}catch(e){throw console.error("Error fetching reports:",e),e}})()},[w,t]),(0,n.createElement)("div",{className:"flex flex-col items-center justify-center w-full mt-8"},E&&100===f&&(0,n.createElement)("div",{className:"w-full mb-6 text-center relative"},(0,n.createElement)("button",{onClick:()=>{C(!1),localStorage.setItem("linkboss_sync_complete_banner_dismissed","true")},className:"absolute top-0 right-0 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition-colors","aria-label":(0,a.__)("Dismiss","semantic-linkboss")},(0,n.createElement)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},(0,n.createElement)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"}))),(0,n.createElement)("p",{className:"text-base font-medium text-green-600 dark:text-green-400 mb-3"},(0,a.__)("Sync Complete! Your content is ready. Build internal links in the LinkBoss App.","semantic-linkboss")),(0,n.createElement)("button",{onClick:()=>window.open("https://app.linkboss.io/app/sites","_blank"),className:"inline-flex items-center gap-2 bg-green-600 text-white hover:bg-green-700 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 transition-colors dark:bg-green-700 dark:hover:bg-green-800"},(0,a.__)("Open LinkBoss App","semantic-linkboss"))),(0,n.createElement)("div",{className:"relative flex flex-col items-center justify-center w-full border-2 border-gray-300 border-dashed rounded-lg dark:bg-gray-900 dark:border-gray-600"},(0,n.createElement)("div",{className:"flex flex-col items-center justify-center pt-20 pb-20 px-4"},(0,n.createElement)(u,{value:f,text:`${f}%`,className:"w-36 h-36 mb-6",styles:(S={pathColor:`rgba(88, 80, 236, ${f/100})`,textColor:"#5850ec",trailColor:"#d6d6d6"},P=S.rotation,L=S.strokeLinecap,A=S.textColor,R=S.textSize,W=S.pathColor,z=S.pathTransition,O=S.pathTransitionDuration,$=S.trailColor,q=S.backgroundColor,T=null==P?void 0:"rotate("+P+"turn)",F=null==P?void 0:"center center",{root:{},path:p({stroke:W,strokeLinecap:L,transform:T,transformOrigin:F,transition:z,transitionDuration:null==O?void 0:O+"s"}),trail:p({stroke:$,strokeLinecap:L,transform:T,transformOrigin:F}),text:p({fill:A,fontSize:R}),background:p({fill:q})})}),(0,n.createElement)("p",{className:"mb-4 text-sm text-gray-500 dark:text-white"},(0,n.createElement)("span",{className:"font-semibold"},(0,a.__)("Click the Sync Now","semantic-linkboss"))," ",(0,a.__)("button for syncing the prepared contents, process may take a while.","semantic-linkboss")),(0,n.createElement)("div",{className:"flex items-center"},(0,n.createElement)("input",{type:"checkbox",className:"w-4 h-4 m-0 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",checked:_,onChange:e=>x(e.target.checked)}),(0,n.createElement)("label",{className:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"},(0,a.__)("Force Sync (For Debug Purpose Only)","semantic-linkboss"))),(0,n.createElement)("div",{className:"flex items-center justify-center mt-6"},(0,n.createElement)("button",{className:"flex items-center gap-2 rounded-md bg-indigo-700 py-3 px-6 border text-sm font-bold text-white transition-all shadow-md hover:shadow-lg focus:bg-indigo-700 active:bg-indigo-700 hover:bg-indigo-800 disabled:pointer-events-none disabled:opacity-50 dark:border-indigo-700",onClick:async()=>{if(d([]),l(!0),m?.queue_remaining>0)try{console.log("Preparing queue..."),await(async()=>{try{for(;;){const e=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(await s(),d([`Preparing... ${m?.queue_remaining} posts left.`]),!0!==e?.data?.has_post){console.log("Queue completed."),d(e=>[...e,"Queue preparation completed."]);break}}}catch(e){throw d(e=>[...e,"Error preparing queue..."]),console.error("Error preparing queue:",e),e}})(),console.log("Queue preparation completed.")}catch(e){return console.error("Queue preparation failed:",e),void d(e=>[...e,"Queue preparation failed."])}if(100===f&&!_)return i().fire({icon:"info",title:"Sync Completed",text:"Your data is already synced.",timer:3e3,timerProgressBar:!0}),e&&setTimeout(()=>{localStorage.setItem("linkboss_setup_wizard_step",2),s()},3e3),void l(!1);try{console.log("Starting sync..."),await(async()=>{try{const e=await(async()=>{try{const e=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),t="urls"===e?.data?.reports?.sync_method;return{posts:t?e?.data?.reports?.urls:e?.data?.reports?.posts,pages:t?0:e?.data?.reports?.pages,category:e?.data?.reports?.total_categories,sync_done:e?.data?.reports?.sync_done,sync_method:e?.data?.reports?.sync_method}}catch(e){throw console.error("Error fetching reports:",e),e}})();await(async e=>{try{const t=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_init",force_data:_?"yes":"no",...e},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if("success"===t?.data?.status){d(e=>[...e,"Syncing ...","Sync Initiated","Syncing Posts..."]);let e=t?.data?.batch?.length;d(e=>[...e,"Processing batches..."]),await N(e)}else i().fire({icon:"error",title:t?.data?.title,text:t?.data?.message})}catch(e){throw i().fire({icon:"error",title:"Error",text:e?.response?.data.message}),e}})(e)}catch(e){if(console.error("Error syncing posts:",e),"rest_no_route"===e?.response?.data?.code)return void i().fire({title:"Oops!",text:(0,a.__)("Please connect your WordPress site with LinkBoss app by adding the API key from Settings.","semantic-linkboss"),icon:"info",showCancelButton:!0,confirmButtonText:"API Settings",cancelButtonText:"Cancel"}).then(e=>{e.isConfirmed&&(window.location.href="admin.php?page=semantic-linkboss#settings")});i().fire({icon:"info",title:"Oops!",text:e?.response?.data?.message+" - "+e?.response?.data?.code})}})(),console.log("Sync completed successfully.")}catch(e){console.error("Error during sync process:",e),d(e=>[...e,"Error during sync process"])}finally{l(!1)}},disabled:o},(0,n.createElement)(b.g,{icon:y.rk5}),o?(0,a.__)("Syncing...","semantic-linkboss"):(0,a.__)("Sync Now","semantic-linkboss")))),(0,n.createElement)("div",{className:"absolute top-0 right-0 p-3"},(0,n.createElement)("ul",{className:"max-w-md space-y-1 text-gray-500 list-inside dark:text-gray-400"},c.map((e,t)=>(0,n.createElement)("li",{key:t,className:"flex items-center"},(0,n.createElement)(b.g,{icon:y.SGM,className:"w-3.5 h-3.5 me-2 text-green-500 dark:text-green-400 shrink-0"}),e))))));var S,P,L,A,R,W,z,O,$,q,T,F}}}]);