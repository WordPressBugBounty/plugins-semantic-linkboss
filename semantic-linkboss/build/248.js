"use strict";(globalThis.webpackChunksemantic_linkboss=globalThis.webpackChunksemantic_linkboss||[]).push([[248],{248:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(609),n=s(723),r=s(513),o=s(939),i=s(83),l=s(465),c=s.n(l),d=s(470);const m=()=>{const{triggerRefresh:e,triggerResetQuery:t}=(0,a.useContext)(r.B),[s,o]=(0,a.useState)(!0),[l,m]=(0,a.useState)([]),[g,u]=(0,a.useState)([]),[b,p]=(0,a.useState)([]),[f,y]=(0,a.useState)([]),[h,_]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(async()=>{try{const[e,t,s]=await Promise.all([i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_wp_post_types"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_custom_query"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_cats_by_post_type"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}})]),a=e.data||[],n=Object.keys(a).map((e=>({id:e,value:e,label:a[e]})));m(n);const r=(t.data.post_sources||[]).map((e=>({id:e,value:e,label:e.charAt(0).toUpperCase()+e.slice(1)})));p(r);const o=t.data.categories||[];u(o.map((e=>({value:e.id,label:e.name}))));const l=s.data||[];u(l.map((e=>({value:e.id,label:e.name}))));const c=t.data.categories||[];y(c.map((e=>{const t=l.find((t=>t.id===parseInt(e)));return t?{value:t.id,label:t.name}:null})).filter(Boolean))}catch(e){console.error("Error fetching data:",e)}finally{o(!1)}})()}),[]);const[k,x]=(0,a.useState)("10"),[v,w]=(0,a.useState)(!1),[E,C]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{(async()=>{try{const[e,t,s]=await Promise.all([i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_sync_speed"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_acf_enabled"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_woo_enabled"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}})]);x(e?.data?.sync_speed),w(t?.data?.acf_enabled),C(s?.data?.woo_enabled)}catch(e){console.error("Error fetching settings:",e)}})()}),[]),s?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"text-center"},(0,n.__)("Loading","semantic-linkboss"),"..."),(0,a.createElement)("div",{className:"flex justify-center items-center h-40 mt-12"},(0,a.createElement)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}))):(0,a.createElement)("div",{className:"relative bg-white dark:bg-gray-900 text-gray-700"},(0,a.createElement)("div",null,(0,a.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-gray-200"},(0,n.__)("Query Builder for Syncing","semantic-linkboss")),(0,a.createElement)("div",{className:"text-gray-500 mb-4 dark:text-gray-300"},(0,n.__)("You can sync specific articles by filtering them by categories or post types. Skip this to sync all articles.","semantic-linkboss")),(0,a.createElement)("h6",{className:"mb-2 text-slate-800 text-md font-semibold dark:text-gray-300"},(0,n.__)("Select Post Types","semantic-linkboss")),(0,a.createElement)(d.Ay,{options:l,value:b,placeholder:"Select Post Types",name:"linkboss_qb[post_sources][]",className:"mb-4",isClearable:!0,isMulti:!0,onChange:async e=>{if(p(e),!e||0===e.length){try{const e=(await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_custom_query"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}})).data.categories||[];u(e.map((e=>({value:e.id,label:e.name}))))}catch(e){console.error("Error fetching categories:",e)}return}const t=e.map((e=>e.value)).filter((e=>"page"!==e));if(0!==t.length)try{const e=(await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings",{action:"get_cats_by_post_type",post_type:t},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}})).data||[];u(e.map((e=>({value:e.id,label:e.name}))))}catch(e){console.error("Error fetching categories:",e)}else u([])}}),(0,a.createElement)("h6",{className:"mb-2 text-slate-800 text-md font-semibold dark:text-gray-300"},(0,n.__)("Select Categories","semantic-linkboss")),(0,a.createElement)(d.Ay,{options:g,placeholder:"Select Categories",name:"linkboss_qb[categories][]",isClearable:!0,isMulti:!0,value:f,onChange:y}),(0,a.createElement)("button",{className:"mt-6 px-6 py-3 bg-indigo-600 text-white rounded hover:bg-indigo-700 font-semibold dark:bg-blue-900 dark:hover:bg-indigo-700",onClick:async()=>{_(!0);try{c().fire({title:"Loading...",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}}),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"save_query",linkboss_qb:{post_sources:b.map((e=>e.value)),categories:f.map((e=>e.value))}},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),c().fire({title:(0,n.__)("Query Settings Saved","semantic-linkboss"),icon:"success",showConfirmButton:!1,timer:1500}),e(),t()}catch(e){console.error("Error saving settings:",e)}finally{_(!1)}},disabled:h},h?(0,n.__)("Saving...","semantic-linkboss"):(0,n.__)("Save Query","semantic-linkboss"))),(0,a.createElement)("hr",{className:"w-48 h-1 mx-auto my-6 bg-gray-100 border-0 rounded-sm dark:bg-gray-700"}),(0,a.createElement)("div",null,(0,a.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-gray-200"},(0,n.__)("ACF Custom Fields Support (Beta)","semantic-linkboss")),(0,a.createElement)("div",{className:"text-gray-500 mb-4 dark:text-gray-300"},(0,n.__)("Enable this option to sync and update Advanced Custom Fields (ACF) content for Gutenberg, Classic, and Elementor.","semantic-linkboss")),(0,a.createElement)("div",{className:"flex items-center mb-4"},(0,a.createElement)("label",{className:"inline-flex items-center cursor-pointer"},(0,a.createElement)("input",{type:"checkbox",className:"sr-only peer",checked:v,onChange:async()=>{try{c().fire({title:"Loading...",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}});const s=!v;w(s),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"save_acf_enabled",acf_enabled:s},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"reset_sync_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),s?c().fire({title:(0,n.__)("ACF Support Enabled & Sync Reset","semantic-linkboss"),text:(0,n.__)("ACF support has been enabled and sync has been reset to ensure all content is processed with the new setting.","semantic-linkboss"),icon:"success",showConfirmButton:!0}):c().fire({title:(0,n.__)("ACF Support Disabled & Sync Reset","semantic-linkboss"),text:(0,n.__)("ACF support has been disabled and sync has been reset to ensure all content is processed with the new setting.","semantic-linkboss"),icon:"success",showConfirmButton:!0}),e(),t()}catch(e){console.error("Error saving ACF settings:",e),c().fire({title:(0,n.__)("Error","semantic-linkboss"),text:(0,n.__)("There was an error updating the settings.","semantic-linkboss"),icon:"error",showConfirmButton:!0})}}}),(0,a.createElement)("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,a.createElement)("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},v?(0,n.__)("Enabled","semantic-linkboss"):(0,n.__)("Disabled","semantic-linkboss")))),(0,a.createElement)("div",{className:"text-gray-500 text-sm mb-4 dark:text-gray-400"},(0,n.__)("Note: After enabling it, please do a reset and force sync.","semantic-linkboss"))),(0,a.createElement)("hr",{className:"w-48 h-1 mx-auto my-6 bg-gray-100 border-0 rounded-sm dark:bg-gray-700"}),(0,a.createElement)("div",null,(0,a.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-gray-200"},(0,n.__)("WooCommerce Category Sync (Beta)","semantic-linkboss")),(0,a.createElement)("div",{className:"text-gray-500 mb-4 dark:text-gray-300"},(0,n.__)("Enable this option to sync WooCommerce product categories and category descriptions.","semantic-linkboss")),(0,a.createElement)("div",{className:"flex items-center mb-4"},(0,a.createElement)("label",{className:"inline-flex items-center cursor-pointer"},(0,a.createElement)("input",{type:"checkbox",className:"sr-only peer",checked:E,onChange:async()=>{try{c().fire({title:"Loading...",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}});const s=!E;C(s),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"save_woo_enabled",woo_enabled:s},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"reset_sync_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),s?c().fire({title:(0,n.__)("WooCommerce Category Sync Enabled & Sync Reset","semantic-linkboss"),text:(0,n.__)("WooCommerce category sync has been enabled and sync has been reset to ensure all content is processed with the new setting.","semantic-linkboss"),icon:"success",showConfirmButton:!0}):c().fire({title:(0,n.__)("WooCommerce Category Sync Disabled & Sync Reset","semantic-linkboss"),text:(0,n.__)("WooCommerce category sync has been disabled and sync has been reset to ensure all content is processed with the new setting.","semantic-linkboss"),icon:"success",showConfirmButton:!0}),e(),t()}catch(e){console.error("Error saving WooCommerce settings:",e),c().fire({title:(0,n.__)("Error","semantic-linkboss"),text:(0,n.__)("There was an error updating the settings.","semantic-linkboss"),icon:"error",showConfirmButton:!0})}}}),(0,a.createElement)("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,a.createElement)("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},E?(0,n.__)("Enabled","semantic-linkboss"):(0,n.__)("Disabled","semantic-linkboss")))),(0,a.createElement)("div",{className:"text-gray-500 text-sm mb-4 dark:text-gray-400"},(0,n.__)("Note: After enabling it, please do a reset and force sync.","semantic-linkboss"))),(0,a.createElement)("hr",{className:"w-48 h-1 mx-auto my-6 bg-gray-100 border-0 rounded-sm dark:bg-gray-700"}),(0,a.createElement)("div",null,(0,a.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-gray-200"},(0,n.__)("Sync Speed","semantic-linkboss")),(0,a.createElement)("div",{className:"text-gray-500 mb-4 dark:text-gray-300"},(0,n.__)("Configure the sync speed for syncing posts or contents with LinkBoss App. Sometimes you may need to slow down the sync speed to avoid server load.","semantic-linkboss")),(0,a.createElement)(d.Ay,{options:[{value:"1",label:"1 Content(Debug Purpose)"},{value:"10",label:"10 Contents"},{value:"20",label:"20 Contents"},{value:"30",label:"30 Contents"},{value:"50",label:"50 Contents"}],defaultValue:{value:"10",label:"10 Contents"},placeholder:"Select Sync Speed",onChange:e=>x(e.value),value:{value:k,label:k+" Contents"}}),(0,a.createElement)("button",{className:"mt-6 px-6 py-3 bg-indigo-600 text-white rounded hover:bg-indigo-700 font-semibold dark:bg-blue-900 dark:hover:bg-indigo-700",onClick:async()=>{try{c().fire({title:"Loading...",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}}),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"save_sync_speed",sync_speed:k},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),c().fire({title:(0,n.__)("Sync Speed Saved","semantic-linkboss"),icon:"success",showConfirmButton:!1,timer:1500})}catch(e){console.error("Error saving settings:",e)}}},(0,n.__)("Save Sync Speed","semantic-linkboss"))),(0,a.createElement)("hr",{className:"w-48 h-1 mx-auto my-6 bg-gray-100 border-0 rounded-sm dark:bg-gray-700"}),(0,a.createElement)("div",null,(0,a.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-gray-200"},(0,n.__)("Reset Sync","semantic-linkboss")),(0,a.createElement)("div",{className:"text-gray-500 mb-4 dark:text-gray-300"},(0,n.__)("This will remove all the queue posts and start syncing from the beginning.","semantic-linkboss")),(0,a.createElement)("button",{className:"px-6 py-3 bg-red-600 text-white rounded hover:bg-red-700 font-semibold dark:bg-red-900 dark:hover:bg-red-700",onClick:async()=>{if((await c().fire({title:(0,n.__)("Are you sure?","semantic-linkboss"),text:(0,n.__)("You won't be able to revert this!","semantic-linkboss"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:(0,n.__)("Yes, reset it!","semantic-linkboss")})).isConfirmed)try{c().fire({title:"Loading...",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}}),await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/settings/update",{action:"reset_sync_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}}),c().fire({title:(0,n.__)("Sync Reset Success.","semantic-linkboss"),icon:"success",showConfirmButton:!1,timer:1500}),e(),t()}catch(e){console.error("Error resetting sync:",e)}}},(0,n.__)("Reset Sync","semantic-linkboss"))))};var g=s(982),u=s(188),b=s(782),p=s(443);const f=()=>{const{refreshKey:e}=(0,a.useContext)(r.B),{triggerRefresh:t}=(0,a.useContext)(r.B),[s,o]=(0,a.useState)(!0),[l,d]=(0,a.useState)({pages:0,posts:0,total_queue_batch:0,on_queue:0,sync_done:0,sync_remaing:0,content_size:"0 KB",elementor_data:0,total_categories:0});let f=parseInt(l?.pages,10)+parseInt(l?.posts,10)-parseInt(l?.total_queue_batch,10);return(0,a.useEffect)((()=>{(async()=>{try{const e=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"prepare"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});d(e?.data?.reports),o(!1)}catch(e){console.error("Error fetching reports:",e),o(!1)}})()}),[e]),(0,a.useEffect)((()=>{localStorage.setItem("linkboss_prepare_reports",JSON.stringify({...l,queueRemaining:f}))}),[l,e]),s?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"text-center"},(0,n.__)("Loading","semantic-linkboss"),"..."),(0,a.createElement)("div",{className:"flex justify-center items-center h-40 mt-12"},(0,a.createElement)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}))):(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"flex items-center gap-6"},(0,a.createElement)("div",{className:"w-[80%]"},(0,a.createElement)("h5",{className:"mb-1 text-slate-800 text-xl font-semibold dark:text-white"},(0,n.__)("Prepare Site Data for Syncing","semantic-linkboss")),(0,a.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},(0,n.__)("This will sync your site with LinkBoss app. One-time setup lets you manage interlinking from app.linkboss.io","semantic-linkboss"))),(0,a.createElement)("div",{className:"w-[20%] justify-items-end"},(0,a.createElement)("div",{className:"flex gap-1"},(0,a.createElement)(b.Pu,null,(0,a.createElement)(b.l9,{children:(0,a.createElement)(g.g,{icon:u.BH7,className:"w-5 h-5"}),component:"button",className:"text-blue-700 border border-blue-500 hover:bg-indigo-500 hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-3 text-center inline-flex items-center me-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:focus:ring-blue-500 dark:hover:bg-indigo-500"}),(0,a.createElement)(b.go,{position:"right",allowEsc:!1,title:(0,a.createElement)("div",{className:"flex items-center gap-2"},(0,a.createElement)(g.g,{icon:u.BH7,className:"w-5 h-5 dark:text-white"}),(0,a.createElement)("span",{className:"text-lg font-semibold dark:text-gray-200"},(0,n.__)("Advanced Sync Settings","semantic-linkboss"))),children:(0,a.createElement)(m,null)})),(0,a.createElement)("button",{className:"rounded-md flex gap-2 items-center bg-indigo-600 text-white border border-transparent py-3 px-4 text-center text-sm font-semibold transition-all hover:bg-indigo-500 focus:bg-indigo-500 active:bg-indigo-500 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none whitespace-nowrap",type:"button",onClick:async()=>{if(0!==l?.queue_remaining){c().fire({title:"Preparing posts...",html:"Please wait while we prepare your posts for syncing.",allowOutsideClick:!1,didOpen:()=>{c().showLoading()}});try{let e=!0,s=0;for(;e;){s++,s>1&&c().update({title:"Preparing posts...",html:`Processing batch #${s}. Please wait...`});const t=await i.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});e=!0===t?.data?.has_post}t(),c().fire({icon:"success",title:"Success",text:"All posts have been prepared for syncing."})}catch(e){console.error("Error preparing queue:",e),c().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."})}}else c().fire({icon:"info",title:"No posts to prepare.",text:"All posts are already prepared for syncing."})}},(0,a.createElement)(g.g,{icon:u.Ys0,className:"w-5 h-5"}),(0,n.__)("Prepare Posts","semantic-linkboss"))))),(0,a.createElement)(p.A,{reports:l,queueRemaining:f}))};var y=s(995);const h=()=>(0,a.createElement)("div",{className:"mt-12 pt-6"},(0,a.createElement)("div",{className:"mb-12 relative flex flex-col bg-clip-border rounded-xl bg-white dark:bg-gray-900 text-gray-700 shadow-sm"},(0,a.createElement)(o.A,{title:"Sync",desc:"Sync your data with LinkBoss App."}),(0,a.createElement)("div",{className:"p-6"},(0,a.createElement)(f,null)),(0,a.createElement)("div",{className:"p-6"},(0,a.createElement)(y.default,null))))},443:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(609),n=s(723),r=s(982),o=s(188);const i=({reports:e,queueRemaining:t})=>(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4"},[{icon:o.A4h,value:e?.pages,label:(0,n.__)("Pages","semantic-linkboss"),bg:"bg-indigo-600"},{icon:o.bLf,value:e?.posts,label:(0,n.__)("Posts","semantic-linkboss"),bg:"bg-orange-600"},{icon:o.TuH,value:e?.on_queue,label:(0,n.__)("On Queue","semantic-linkboss"),bg:"bg-pink-600"},{icon:o.a$,value:t<0?0:t,label:(0,n.__)("Queue Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.a$,value:e?.sync_remaing,label:(0,n.__)("Sync Remaining","semantic-linkboss"),bg:"bg-amber-800"},{icon:o.rk5,value:e?.sync_done,label:(0,n.__)("Sync Done","semantic-linkboss"),bg:"bg-green-700"},{icon:o.BH7,value:e.total_categories,label:(0,n.__)("Total Categories","semantic-linkboss"),bg:"bg-teal-600"},{icon:o.hem,value:e?.content_size,label:(0,n.__)("Content Size","semantic-linkboss"),bg:"bg-purple-600"}].map(((e,t)=>(0,a.createElement)("div",{key:t,className:"flex items-center px-5 py-6 bg-white dark:bg-gray-800 rounded-md shadow-sm"},(0,a.createElement)("div",{className:`p-4 ${e.bg} bg-opacity-75 rounded-full leading-none`},(0,a.createElement)(r.g,{icon:e.icon,className:"w-6 h-6 text-white"})),(0,a.createElement)("div",{className:"mx-5"},(0,a.createElement)("h4",{className:"text-2xl font-semibold text-gray-700 dark:text-gray-200"},e.value),(0,a.createElement)("div",{className:"text-gray-500 dark:text-gray-400"},e.label)))))))},939:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(609),n=s(723);const r=({title:e,desc:t})=>(0,a.createElement)("div",{className:"relative bg-clip-border mx-4 rounded-xl overflow-hidden bg-gradient-to-tr from-indigo-800 to-indigo-400 text-white shadow-indigo-500/40 shadow-lg -mt-12 mb-8 p-6"},(0,a.createElement)("div",{className:"flex w-full items-center justify-between"},(0,a.createElement)("div",null,(0,a.createElement)("h6",{className:"block antialiased tracking-normal font-sans text-base font-semibold leading-relaxed text-white mt-0 mb-1"},(0,n.__)(e,"semantic-linkboss")),(0,a.createElement)("div",{className:"block antialiased font-sans text-md font-normal dark:text-gray-300"},(0,n.__)(t,"semantic-linkboss")))))},995:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var a=s(609),n=s(723),r=s(83),o=s(465),i=s.n(o),l=s(237),c=s(513),d=s(982),m=s(188);const g=({isWizard:e=!1})=>{const{resetQuery:t}=(0,a.useContext)(c.B),{triggerRefresh:s}=(0,a.useContext)(c.B),[o,g]=(0,a.useState)(!1),[u,b]=(0,a.useState)([]),[p,f]=(0,a.useState)([]),[y,h]=(0,a.useState)(0),[_,k]=(0,a.useState)(!1),[x,v]=(0,a.useState)(0),w=async t=>{try{const a=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"prepare_batch_for_sync"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(e||s(),400===a?.data?.data?.srv_status?.status)return void i().fire({icon:"error",title:"Error",html:a?.data?.data?.srv_status?.msg});if("yes"===a?.data?.data?.has_batch){let e=(t-a?.data?.data?.batch_length)/t*100;h(Math.round(100*e)/100),await w(t)}else b((e=>[...e,"Sync Completed"])),h(100),E()}catch(e){i().fire({icon:"error",title:"Error",text:"Error preparing queue. Please try again."}),console.error("Error preparing queue:",e)}},E=async()=>{try{const t=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_finish"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});"success"===t?.data?.status?(b((e=>[...e,"Category Sync Finished","Syncing Finished"])),b((e=>[...e,"Sync Finished"])),i().fire({icon:"success",title:t?.data?.title,html:t?.data?.message,timer:3e3,timerProgressBar:!0}),v(!0),e&&setTimeout((()=>{localStorage.setItem("linkboss_setup_wizard_step",2)}),1500),s()):i().fire({icon:"error",title:t?.data?.title,html:t?.data?.message})}catch(e){console.error("Error finishing sync:",e)}};return(0,a.useEffect)((()=>{(async()=>{try{const e=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts-2"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});let t=e?.data?.reports?.sync_done,s=e?.data?.reports?.sync_remaing,a=t/(t+s)*100||0;o||h(Math.round(100*a)/100),f(e?.data?.reports)}catch(e){throw console.error("Error fetching reports:",e),e}})()}),[x,t]),(0,a.createElement)("div",{className:"flex items-center justify-center w-full mt-8"},(0,a.createElement)("div",{className:"relative flex flex-col items-center justify-center w-full border-2 border-gray-300 border-dashed rounded-lg dark:bg-gray-900 dark:border-gray-600"},(0,a.createElement)("div",{className:"flex flex-col items-center justify-center pt-20 pb-20 px-4"},(0,a.createElement)(l.QF,{value:y,text:`${y}%`,className:"w-36 h-36 mb-6",styles:(0,l.Hf)({pathColor:`rgba(88, 80, 236, ${y/100})`,textColor:"#5850ec",trailColor:"#d6d6d6"})}),(0,a.createElement)("p",{className:"mb-4 text-sm text-gray-500 dark:text-white"},(0,a.createElement)("span",{className:"font-semibold"},(0,n.__)("Click to Sync Now","semantic-linkboss"))," ",(0,n.__)("for a seamless experience, process may take a while.","semantic-linkboss")),(0,a.createElement)("div",{className:"flex items-center"},(0,a.createElement)("input",{type:"checkbox",className:"w-4 h-4 m-0 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",checked:_,onChange:e=>k(e.target.checked)}),(0,a.createElement)("label",{className:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"},(0,n.__)("Force Sync - ","semantic-linkboss"),(0,a.createElement)("a",{className:"text-blue-600 dark:text-blue-500 hover:underline ml-1"},(0,n.__)("(to Sync all posts)","semantic-linkboss")),".")),(0,a.createElement)("div",{className:"flex items-center justify-center mt-6"},(0,a.createElement)("button",{className:"flex items-center gap-2 rounded-md bg-indigo-700 py-3 px-6 border text-sm font-bold text-white transition-all shadow-md hover:shadow-lg focus:bg-indigo-700 active:bg-indigo-700 hover:bg-indigo-800 disabled:pointer-events-none disabled:opacity-50 dark:border-indigo-700",onClick:async()=>{if(b([]),g(!0),p?.queue_remaining>0)try{console.log("Preparing queue..."),await(async()=>{try{for(;;){const e=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init/set",{action:"init_posts_ids_batch"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if(await s(),b([`Preparing... ${p?.queue_remaining} posts left.`]),!0!==e?.data?.has_post){console.log("Queue completed."),b((e=>[...e,"Queue preparation completed."]));break}}}catch(e){throw b((e=>[...e,"Error preparing queue..."])),console.error("Error preparing queue:",e),e}})(),console.log("Queue preparation completed.")}catch(e){return console.error("Queue preparation failed:",e),void b((e=>[...e,"Queue preparation failed."]))}if(100===y&&!_)return i().fire({icon:"info",title:"Sync Completed",text:"Your data is already synced.",timer:3e3,timerProgressBar:!0}),e&&setTimeout((()=>{localStorage.setItem("linkboss_setup_wizard_step",2),s()}),3e3),void g(!1);try{console.log("Starting sync..."),await(async()=>{try{const e=await(async()=>{try{const e=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/init",{action:"init_batch_reports",who:"syncPosts"},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});return{posts:e?.data?.reports?.posts,pages:e?.data?.reports?.pages,category:e?.data?.reports?.total_categories,sync_done:e?.data?.reports?.sync_done}}catch(e){throw console.error("Error fetching reports:",e),e}})();await(async e=>{try{const t=await r.A.post(LinkBossConfig?.rest_url+"linkboss/v1/sync",{action:"sync_init",force_data:_?"yes":"no",...e},{headers:{"X-WP-Nonce":LinkBossConfig.nonce}});if("success"===t?.data?.status){b((e=>[...e,"Syncing ...","Sync Initiated","Syncing Posts..."]));let e=t?.data?.batch?.length;b((e=>[...e,"Processing batches..."])),await w(e)}else i().fire({icon:"error",title:t?.data?.title,text:t?.data?.message})}catch(e){throw i().fire({icon:"error",title:"Error",text:e?.response?.data.message}),e}})(e)}catch(e){if(console.error("Error syncing posts:",e),"rest_no_route"===e?.response?.data?.code)return void i().fire({title:"Oops!",text:(0,n.__)("Please connect your WordPress site with LinkBoss app by adding the API key from Settings.","semantic-linkboss"),icon:"info",showCancelButton:!0,confirmButtonText:"Settings",cancelButtonText:"Cancel"}).then((e=>{e.isConfirmed&&document.querySelector('li[data-value="settings"]').click()}));i().fire({icon:"info",title:"Oops!",text:e?.response?.data?.message+" - "+e?.response?.data?.code})}})(),console.log("Sync completed successfully.")}catch(e){console.error("Error during sync process:",e),b((e=>[...e,"Error during sync process"]))}finally{g(!1)}},disabled:o},(0,a.createElement)(d.g,{icon:m.rk5}),o?(0,n.__)("Syncing...","semantic-linkboss"):(0,n.__)("Sync Now","semantic-linkboss")))),(0,a.createElement)("div",{className:"absolute top-0 right-0 p-3"},(0,a.createElement)("ul",{className:"max-w-md space-y-1 text-gray-500 list-inside dark:text-gray-400"},u.map(((e,t)=>(0,a.createElement)("li",{key:t,className:"flex items-center"},(0,a.createElement)(d.g,{icon:m.SGM,className:"w-3.5 h-3.5 me-2 text-green-500 dark:text-green-400 shrink-0"}),e)))))))}}}]);